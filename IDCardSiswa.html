<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>ID Card Siswa JR EDUCATION</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 30px;
      background: #f4f6f9;
    }
    .card {
      display: inline-block;
      padding: 20px;
      border: 2px solid #333;
      border-radius: 12px;
      background: #fff;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      max-width: 350px;
    }
    img {
      width: 150px;
      height: auto;
      border-radius: 8px;
      margin-top: 10px;
      border: 2px solid #555;
    }
    h2 {
      margin-bottom: 10px;
      color: #222;
    }
    p {
      margin: 6px 0;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div id="hasil">
    <p>Sedang memuat data siswa...</p>
  </div>

  <script>
    // Ambil parameter dari URL (?nis=...)
    const params = new URLSearchParams(window.location.search);
    const nis = params.get("nis");

    // Link JSON dari Google Sheet (pakai opensheet.elk.sh)
    const sheetURL = "https://opensheet.elk.sh/1LWHkjnO6BZ-QC9CjxEStDiqklgQ_ZYSFoVgLtokf3PM/IDCard";

    // Fungsi untuk ubah link Google Drive jadi direct link
    function fixDriveLink(url) {
      if (!url) return "";
      const match = url.match(/\/d\/([^/]+)\//);
      if (match) {
        return "https://drive.google.com/uc?export=view&id=" + match[1];
      }
      return url; // kalau sudah direct link
    }

    fetch(sheetURL)
      .then(res => res.json())
      .then(data => {
        const siswa = data.find(s => s.NIS === nis);
        const hasilDiv = document.getElementById("hasil");

        if (siswa) {
          const fotoUrl = fixDriveLink(siswa.FOTO || "");
          hasilDiv.innerHTML = `
            <div class="card">
              <h2>Siswa berikut merupakan siswa JR EDUCATION</h2>
              <p><b>Nama:</b> ${siswa.NAMA}</p>
              <p><b>NIS:</b> ${siswa.NIS}</p>
              <p><b>Sekolah:</b> ${siswa.SEKOLAH || "-"}</p>
              ${fotoUrl ? `<img src="${fotoUrl}" alt="Foto Siswa">` : "<p><i>Foto tidak tersedia</i></p>"}
            </div>
          `;
        } else {
          hasilDiv.innerHTML = "<p style='color:red'>❌ Data siswa tidak ditemukan</p>";
        }
      })
      .catch(err => {
        console.error("Error:", err);
        document.getElementById("hasil").innerHTML = "<p style='color:red'>⚠️ Terjadi kesalahan saat mengambil data</p>";
      });
  </script>
</body>
</html>
